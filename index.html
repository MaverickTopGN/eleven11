<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Marcadores — Pro TV</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;600;700;800;900&family=Source+Sans+3:wght@400;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#06110b; --bg2:#0a1a11; --txt:#eafff2; --muted:#a8c7b7;
  --line:rgba(255,255,255,.10); --live:#60a5fa; --good:#34d399; --ns:#a7f3d0;
  --radius:18px;
}
*{box-sizing:border-box}
body{
  margin:0; color:var(--txt);
  font-family:Inter,system-ui;
  background:linear-gradient(180deg,var(--bg),var(--bg2));
}
.wrap{max-width:1200px;margin:auto;padding:20px}

/* ---------- HEADER ---------- */
header{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap}
.brand{display:flex;gap:12px;align-items:center}
.brandLogo{width:44px;height:44px;border-radius:14px;background:linear-gradient(135deg,#22c55e,#60a5fa)}
.brandTitle{font-weight:900}
.controls{display:flex;gap:10px}

/* ---------- TABS ---------- */
.tabs{
  display:flex;gap:10px;overflow-x:auto;
  margin:18px 0;padding:10px;
  border-radius:var(--radius);
  background:rgba(255,255,255,.04)
}
.tab{
  padding:10px 14px;border-radius:999px;
  font-weight:900;font-size:13px;
  color:var(--muted);
  cursor:pointer;white-space:nowrap;
}
.tab[aria-selected="true"]{
  color:var(--txt);
  background:rgba(255,255,255,.12)
}

/* ---------- MATCH LIST ---------- */
.match{
  display:grid;grid-template-columns:100px 1fr;
  gap:12px;padding:14px;margin-bottom:12px;
  border-radius:16px;
  background:rgba(255,255,255,.04);
  cursor:pointer
}
.time{font-size:12px;color:var(--muted);font-weight:800}
.badge{font-size:11px;font-weight:900}
.broadcast{
  display:grid;grid-template-columns:auto 80px auto;
  align-items:center;gap:10px
}
.logoBig{width:44px;height:44px;object-fit:contain}
.scoreCenter{
  text-align:center;
  font-weight:900;
  padding:6px;border-radius:10px;
  background:rgba(255,255,255,.08)
}
.subline{font-size:10px;color:var(--muted);text-align:center}

/* ---------- MODAL ---------- */
.modalOverlay{
  position:fixed;inset:0;
  background:rgba(0,0,0,.6);
  display:none;align-items:flex-end;justify-content:center
}
.modalOverlay.show{display:flex}
.modal{
  width:100%;max-width:900px;
  border-radius:24px 24px 0 0;
  background:#050907;
  padding:16px;
}
.modalTop{display:flex;justify-content:space-between;align-items:center}
.modalLeague{display:flex;gap:8px;align-items:center;font-weight:900}
.modalLeague img{width:18px;height:18px}
.closeBtn{cursor:pointer;font-size:18px}
.modalScoreRow{
  display:grid;grid-template-columns:1fr auto 1fr;
  align-items:center;margin:14px 0
}
.modalTeam{display:flex;gap:10px;align-items:center}
.modalTeam img{width:48px;height:48px}
.modalScore{font-size:38px;font-weight:900}
.modalTabs{display:flex;gap:10px;margin-top:10px}
.modalTab{
  padding:8px 14px;border-radius:999px;
  font-weight:900;font-size:13px;
  color:var(--muted);cursor:pointer
}
.modalTab.active{
  color:var(--txt);
  background:rgba(255,255,255,.12)
}
.modalBody{margin-top:14px}
.smallMuted{color:var(--muted);font-size:12px;font-weight:700}
</style>
</head>

<body>
<div class="wrap">

<header>
  <div class="brand">
    <div class="brandLogo"></div>
    <div class="brandTitle">Marcadores — Pro TV</div>
  </div>
  <div class="controls">
    <button id="refreshBtn">Actualizar</button>
  </div>
</header>

<!-- TABS -->
<nav class="tabs">
  <button class="tab" aria-selected="true" data-league="EPL">Premier</button>
  <button class="tab" data-league="LL">LaLiga</button>
  <button class="tab" data-league="L1">Ligue 1</button>
  <button class="tab" data-league="UCL">Champions</button>
  <button class="tab" data-league="LMX">Liga MX</button>
  <button class="tab" data-league="EFLC">EFL Cup</button>
  <button class="tab" data-league="CDR">Copa del Rey</button>
</nav>

<!-- MATCHES -->
<div id="matches"></div>

</div>

<!-- MODAL -->
<div class="modalOverlay" id="modalOverlay">
  <div class="modal">
    <div class="modalTop">
      <div class="modalLeague" id="modalLeague"></div>
      <div class="closeBtn" id="closeModal">✕</div>
    </div>

    <div class="modalScoreRow">
      <div class="modalTeam" id="modalHome"></div>
      <div class="modalScore" id="modalScore">—</div>
      <div class="modalTeam" id="modalAway"></div>
    </div>

    <div class="modalTabs">
      <div class="modalTab active" data-tab="overview">Overview</div>
      <div class="modalTab" data-tab="stats">Stats</div>
      <div class="modalTab" data-tab="events">Play-by-Play</div>
      <div class="modalTab" data-tab="standings">Standings</div>
    </div>

    <div class="modalBody" id="modalBody">
      <div class="smallMuted">Selecciona un partido</div>
    </div>
  </div>
</div>

<script>
/* ---------- LEAGUES + LOGOS ---------- */
const LEAGUES = {
  EPL:  { name:"Premier League", id:39,  logo:"https://media.api-sports.io/football/leagues/39.png" },
  LL:   { name:"LaLiga", id:140, logo:"https://media.api-sports.io/football/leagues/140.png" },
  L1:   { name:"Ligue 1", id:61,  logo:"https://media.api-sports.io/football/leagues/61.png" },
  UCL:  { name:"Champions League", id:2,   logo:"https://media.api-sports.io/football/leagues/2.png" },
  LMX:  { name:"Liga MX", id:262, logo:"https://media.api-sports.io/football/leagues/262.png" },
  EFLC: { name:"EFL Cup", id:48,  logo:"https://media.api-sports.io/football/leagues/48.png" },
  CDR:  { name:"Copa del Rey", id:143, logo:"https://media.api-sports.io/football/leagues/143.png" },
};

let active = "EPL";

/* ---------- API ---------- */
async function api(endpoint, params={}){
  const u=new URL("/.netlify/functions/football", location.origin);
  u.searchParams.set("endpoint", endpoint);
  Object.entries(params).forEach(([k,v])=>u.searchParams.set(k,v));
  const r=await fetch(u); return r.json();
}

/* ---------- LOAD MATCHES ---------- */
async function loadMatches(){
  const league = LEAGUES[active];
  const j = await api("fixtures",{ league: league.id, next: 15 });
  const data = j.response || [];

  const el = document.getElementById("matches");
  el.innerHTML = data.map(f=>{
    const h=f.teams.home, a=f.teams.away;
    const status=f.fixture.status.short;
    return `
      <div class="match" onclick='openModal(${JSON.stringify(f).replace(/'/g,"&apos;")})'>
        <div class="time">${f.fixture.date.slice(11,16)} <span class="badge">${status}</span></div>
        <div class="broadcast">
          <img class="logoBig" src="${h.logo}">
          <div>
            <div class="scoreCenter">${status==="NS"?"VS":`${f.goals.home}-${f.goals.away}`}</div>
            <div class="subline">${status==="NS"?"PROX":"LIVE"}</div>
          </div>
          <img class="logoBig" src="${a.logo}">
        </div>
      </div>`;
  }).join("");
}

/* ---------- MODAL ---------- */
function openModal(f){
  document.getElementById("modalOverlay").classList.add("show");

  const L=LEAGUES[active];
  document.getElementById("modalLeague").innerHTML =
    `<img src="${L.logo}">${L.name}`;

  document.getElementById("modalHome").innerHTML =
    `<img src="${f.teams.home.logo}"><b>${f.teams.home.name}</b>`;
  document.getElementById("modalAway").innerHTML =
    `<b>${f.teams.away.name}</b><img src="${f.teams.away.logo}">`;

  document.getElementById("modalScore").textContent =
    f.fixture.status.short==="NS"?"—":`${f.goals.home}-${f.goals.away}`;

  document.getElementById("modalBody").innerHTML =
    `<div class="smallMuted">Overview real ya conectado.</div>`;
}

document.getElementById("closeModal").onclick=()=>{
  document.getElementById("modalOverlay").classList.remove("show");
};

/* ---------- TABS ---------- */
document.querySelectorAll(".tab").forEach(tab=>{
  tab.onclick=()=>{
    document.querySelectorAll(".tab").forEach(t=>t.setAttribute("aria-selected","false"));
    tab.setAttribute("aria-selected","true");
    active=tab.dataset.league;
    loadMatches();
  };
});

document.getElementById("refreshBtn").onclick=loadMatches;

/* ---------- INIT ---------- */
loadMatches();
</script>
</body>
</html>
